2.3 개발자를 위한 테스팅 프레임워크 JUnit
=
스프링의 핵심 기능 중 하나인 스프링 테스트 모듈도 JUnit을 이용함
## 2.3.2 테스트 결과의 일관성
- 코드에 변경사항이 없다면 테스트는 항상 동일한 결과를 내야 함

### deleteAll()과 getCount() 추가
- deleteAll() 메소드: USER 테이블의 모든 레코드를 삭제
- getCount() 메소드: USER 테이블의 레코드 개수를 돌려줌

### deleteAll()과 getCount()의 테스트
-

### 동일한 결과를 보장하는 테스트
- 테스트하기 전에 테스트 실행에 문제가 되지 않는 상태를 만들어주는 편이 나음
- 단위 테스트는 항상 일관성 있는 결과가 보장돼야 한다는 점
  - DB에 남아 있는 데이터와 같은 외부 환경에 영향을 받지 말아야 함
  - 테스트를 실행하는 순서를 바꿔도 동일한 결과가 보장되도록 만들어져야 함

## 2.3.3 포괄적인 테스트
- JUnit은 하나의 클래스 안에 여러 개의 테스트 메소드가 들어가는 것을 허용함
- @Test가 붙어 있고 public 접근자가 있으며 리턴 값이 void형이고 파라미터가 없다는 조건을 지키기만 하면 됨

- 주의해야 할 점은 두 개의 테스트가 어떤 순서로 실행될지는 알 수 없음
- JUnit은 특정한 테스트 메소드의 실행 순서를 보장해주지 않음
- 테스트 진행 중에 특정 예외가 던져지면 테스트가 성공한 것이고, 예외가 던져지지 않고 정상적으로 작업을 마치면 테스트가 실패했다고 판단해야 함
- 예외 발생 여부는 메소드를 실행해서 리턴 값을 비교하는 방법으로 확인할 수 없다는 점
- 즉 assertThat() 메소드로는 검증 불가능

- "항상 네거티브 테스트를 먼저 만들라" &rarr; 테스트를 작성할 때 부정적인 케이스를 먼저 만드는 습관을 들이는 게 좋음

## 2.3.4 테스트가 이끄는 개발
- get() 메소드의 예외 테스트를 만드는 과정: 테스트를 먼저 만들어 테스트가 실패하는 것을 보고 나서 UserDao의 코드에 손을 대기 시작함
&rarr; 테스트할 코드도 안 만들어놓고 테스트 코드부터 만드는 것


### 테스트 주도 개발 (TDD, Test Driven Development) / 테스트 우선 개발 (Test First Development)
- 만들고자 하는 기능의 내용을 담고 있으면서 만들어진 코드를 검증도 해줄 수 있도록 테스트 코드를 먼저 만들고, 테스트를 성공하게 해주는 코드를 작성하는 방식의 개발 방식
- 개발자가 테스트를 만들어가며 개발하는 방법이 주는 장점을 극대화한 방법
- 아예 테스트를 먼저 만들고 그 테스트가 성공하도록 하는 코드만 만드는 식으로 진행하기 때문에 테스트를 빼먹지 않고 꼼꼼하게 만들어낼 수 있음
- 테스트를 작성하는 시간과 애플리케이션 코드를 작성하는 시간의 간격이 짧아진다. &rarr; 코드에 대한 피드백을 매우 빠르게 받을 수 있게 됨
- TDD에서는 테스트 작성하고 이를 성공시키는 코드를 만드는 작업의 주기를 가능한 한 짧게 가져가도록 권장함
- TDD를 하면 자연스럽게 단위 테스트를 만들 수 있음

## 2.3.5 테스트 코드 개선
### @Before
- JUnit이 제공하는 애노테이션
- @Test 메소드가 실행되기 전에 먼저 실행돼야 하는 메소드를 정의함
### @After
- JUnit이 제공하는 애노테이션
- @Test 메소드가 실행된 후에 실행돼야 하는 메소드를 정의함

### JUnit이 하나의 테스트 클래스를 가져와 테스트를 수행하는 방식
1. 테스트 클래스에서 @Test가 붙은 public이고 void형이며 파라미터가 없는 테스트 메소드를 모두 찾는다.
2. 테스트 클래스의 오브젝트를 하나 만든다.
3. @Before가 붙은 메소드가 있으면 실행한다.
4. @Test가 붙은 메소드를 하나 호출하고 테스트 결과를 저장해둔다.
5. @After가 붙은 메소드가 있으면 실행한다.
6. 나머지 테스트 메소드에 대해 2~5번을 반복한다.
7. 모든 테스트의 결과를 종합해서 돌려준다.

- 기억해야 할 사항: 각 테스트 메소드를 실행할 때마다 테스트 클래스의 오브젝트를 새로 만든다는 점. 한번 만들어진 테스트 클래스의 오브젝트는 하나의 테스트 메소드를 사용하고 나면 버려진다.
- 테스트 메소드의 일부에서만 공통적으로 사용되는 코드가 있다면? 
  - @Before를 사용하기보다는, 일반적인 메소드 추출 방법을 써서 메소드를 분리하고 테스트 메소드에서 직접 호출해 사용하도록 만들기
  - 아예 공통적인 특징을 지닌 테스트 메소드를 모아서 별도의 테스트 클래스로 만들기

### 픽스처
- 테스트를 수행하는 데 필요한 정보나 오브젝트
- 일반적으로 픽스처는 여러 테스트에서 반복적으로 사용되기 때문에 @Before 메소드를 이용해 생성해두면 편리함